syntax = "proto3";

package io.elkia.fleet.v1alpha1;

option go_package = "pkg/api/fleet/v1alpha1";

import "google/protobuf/empty.proto";

message Cluster {
  string id = 1;
  uint32 world_id = 2;
  string name = 3;
}

message Gateway {
  string id = 1;
  uint32 channel_id = 2;
  string address = 3;
  uint32 population = 4;
  uint32 capacity = 5;
}

message Handoff {
  string id = 1;
  string identifier = 2;
  string token = 3;
}

message Session {
  string id = 1;
  string identity_id = 2;
  string token = 3;
}

message ListClusterRequest {}

message ListClusterResponse { repeated Cluster clusters = 1; }

message GetClusterRequest { string id = 1; }

message ListGatewayRequest { string id = 1; }

message ListGatewayResponse { repeated Gateway gateways = 1; }

message GetGatewayRequest { string id = 1; }

message CreateHandoffRequest {
  string identifier = 1;
  string token = 2;
}

message CreateHandoffResponse { uint32 key = 1; }

message PerformHandoffRequest {
  uint32 key = 1;
  string token = 2;
}

service Fleet {
  rpc ListClusters(ListClusterRequest) returns (ListClusterResponse);
  rpc GetCluster(GetClusterRequest) returns (Cluster);
  rpc ListGateways(ListGatewayRequest) returns (ListGatewayResponse);
  rpc GetGateway(GetGatewayRequest) returns (Gateway);
  rpc CreateHandoff(CreateHandoffRequest) returns (CreateHandoffResponse);
  rpc PerformHandoff(PerformHandoffRequest) returns (google.protobuf.Empty);
}
